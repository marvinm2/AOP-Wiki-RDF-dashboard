<section class="tab-intro">
    <h2>How to Use This Dashboard</h2>
    <p>
        This dashboard provides interactive visualizations of the AOP-Wiki database evolution over time.
        Toggle between absolute values (total counts) and deltas (changes since previous release) using the button below.
        Use the navigation buttons to jump to different sections.
    </p>
</section>

<!-- Navigation Buttons -->
<div style="text-align:center; margin:20px;">
    <button class="nav-button" onclick="document.getElementById('main-trends').scrollIntoView({behavior:'smooth'});">Main Trends</button>
    <button class="nav-button" onclick="document.getElementById('network-connectivity').scrollIntoView({behavior:'smooth'});">Connectivity</button>
    <button class="nav-button" onclick="document.getElementById('authors').scrollIntoView({behavior:'smooth'});">Authors & Lifetime</button>
    <button class="nav-button" onclick="document.getElementById('ke-components').scrollIntoView({behavior:'smooth'});">KE Components</button>
</div>

<!-- Bulk Download Section -->
<div style="text-align:center; margin:20px; padding:15px; background-color: #f9f9f9; border-radius: 8px;">
    <h3 style="margin-top:0; color:#29235C;">📦 Bulk Download</h3>
    <p style="font-size:14px; color:#666; margin:10px 0;">Download all trend plots at once in multiple formats</p>
    <div style="display:flex; gap:10px; justify-content:center; flex-wrap:wrap;">
        <a href="/download/bulk?category=trends-all&formats=csv,png,svg" class="nav-button" style="text-decoration:none; display:inline-block;">
            📥 Download All (CSV + PNG + SVG)
        </a>
        <a href="/download/bulk?category=trends-all&formats=csv" class="nav-button" style="text-decoration:none; display:inline-block;">
            📄 CSV Only
        </a>
        <a href="/download/bulk?category=trends-all&formats=png" class="nav-button" style="text-decoration:none; display:inline-block;">
            🖼️ PNG Only
        </a>
    </div>
    <p style="font-size:12px; color:#999; margin:10px 0;">Or download by category:</p>
    <div style="display:flex; gap:8px; justify-content:center; flex-wrap:wrap; font-size:13px;">
        <a href="/download/bulk?category=trends-main&formats=png" style="color:#307BBF;">Main Trends</a>
        <a href="/download/bulk?category=trends-network&formats=png" style="color:#307BBF;">Network</a>
        <a href="/download/bulk?category=trends-components&formats=png" style="color:#307BBF;">Components</a>
        <a href="/download/bulk?category=trends-ontology&formats=png" style="color:#307BBF;">Ontology</a>
    </div>
</div>

<!-- Global Toggle -->
<div style="text-align:center; padding: 20px;">
    <button id="toggle-delta" class="toggle-button">Switch to Delta Mode</button>
</div>

<section class="section-block" id="main-trends">
    <!-- Main trends -->
    <h2 class="section-header">Main Entity Trends</h2>
    <div class="plot-grid">
    <div class="plot-box" id="main-trends">
        <div class="plot-header">
            <h3>AOP Entity Counts</h3>
            <div style="display: flex; gap: 10px; align-items: center;">
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Absolute ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/aop_entity_counts_absolute?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/aop_entity_counts_absolute?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/aop_entity_counts_absolute?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Delta ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/aop_entity_counts_delta?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/aop_entity_counts_delta?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/aop_entity_counts_delta?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <label><input type="checkbox" class="plot-toggle"> Show Deltas</label>
            </div>
        </div>
        <p class="plot-description">
            Tracks the total number of AOPs, Key Events (KEs), Key Event Relationships (KERs), 
            and Stressors over time.
        </p>
        <div class="abs">
            <div class="lazy-plot" data-plot-name="aop_entity_counts_absolute">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
        <div class="delta" style="display:none;">
            <div class="lazy-plot" data-plot-name="aop_entity_counts_delta">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
    </div>



    <!-- AOP Property Presence -->
    <div class="plot-box full-width" id="aop-property-presence">
        <div class="plot-header">
            <h3>AOP Property Presence Over Time</h3>
            <div style="display: flex; gap: 10px; align-items: center;">
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Absolute ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/aop_property_presence_absolute?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/aop_property_presence_absolute?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/aop_property_presence_absolute?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Percentage ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/aop_property_presence_percentage?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/aop_property_presence_percentage?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/aop_property_presence_percentage?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <label><input type="checkbox" class="plot-toggle"> Show Percentage</label>
            </div>
        </div>
        <p class="plot-description">
            Shows how many AOPs contain each property over time. 
            Properties always present (100%) are excluded for clarity.
        </p>
        <div class="abs">
            <div class="lazy-plot" data-plot-name="aop_property_presence_absolute">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
        <div class="delta" style="display:none;">
            <div class="lazy-plot" data-plot-name="aop_property_presence_percentage">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
    </div>

    <!-- AOP Property Presence - Unique Colors -->
    <div class="plot-box full-width" id="aop-property-presence-unique">
        <div class="plot-header">
            <h3>AOP Property Presence Over Time - Unique Colors</h3>
            <div style="display: flex; gap: 10px; align-items: center;">
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Absolute ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/aop_property_presence_unique_absolute?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/aop_property_presence_unique_absolute?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/aop_property_presence_unique_absolute?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Percentage ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/aop_property_presence_unique_percentage?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/aop_property_presence_unique_percentage?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/aop_property_presence_unique_percentage?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <label><input type="checkbox" class="plot-toggle"> Show Percentage</label>
            </div>
        </div>
        <p class="plot-description">
            Same AOP property presence trends with unique colors for each property line instead of repeating colors.
            Larger panel for better visualization of all property trends.
        </p>
        <div class="abs">
            <div class="lazy-plot" data-plot-name="aop_property_presence_unique_absolute">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
        <div class="delta" style="display:none;">
            <div class="lazy-plot" data-plot-name="aop_property_presence_unique_percentage">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
    </div>
    </div>
</section>

<section class="section-block" id="network-connectivity">
    <!-- Average KEs/KERs -->
    <h2 class="section-header">AOP Connectivity and Network Structure</h2>
    <div class="plot-grid">
    <div class="plot-box" id="avg-per-aop">
        <div class="plot-header">
            <h3>Average KEs and KERs per AOP</h3>
            <div style="display: flex; gap: 10px; align-items: center;">
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Absolute ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/average_components_per_aop_absolute?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/average_components_per_aop_absolute?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/average_components_per_aop_absolute?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Delta ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/average_components_per_aop_delta?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/average_components_per_aop_delta?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/average_components_per_aop_delta?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <label><input type="checkbox" class="plot-toggle"> Show Deltas</label>
            </div>
        </div>
        <p class="plot-description">
            Shows how densely connected each AOP is on average, 
            measured by the number of Key Events and Key Event Relationships per AOP.
        </p>
        <div class="abs">
            <div class="lazy-plot" data-plot-name="average_components_per_aop_absolute">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
        <div class="delta" style="display:none;">
            <div class="lazy-plot" data-plot-name="average_components_per_aop_delta">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
    </div>
    <!-- AOP Network Density -->
    <div class="plot-box" id="density">
        <div class="plot-header">
            <h3>AOP Network Density</h3>
            <div class="download-dropdown">
                <button class="download-button dropdown-toggle">Download ▼</button>
                <div class="dropdown-menu">
                    <a href="/download/trend/aop_network_density?format=csv" class="dropdown-item">📄 CSV</a>
                    <a href="/download/trend/aop_network_density?format=png" class="dropdown-item">🖼️ PNG</a>
                    <a href="/download/trend/aop_network_density?format=svg" class="dropdown-item">📐 SVG</a>
                </div>
            </div>
        </div>
        <p class="plot-description">
            Shows how densely connected the KE-KER graph is over time,
            calculated as the ratio of edges to possible connections between nodes.
        </p>
        <div class="lazy-plot" data-plot-name="aop_network_density">
            <!-- Plot will be loaded here via JavaScript -->
        </div>
    </div>

    </div>
</section>

<section class="section-block" id="authors">
    <!-- Authors -->
    <h2 id="authors" class="section-header">Authors and AOP Lifetime</h2>
    <div class="plot-grid">
    <div class="plot-box" id="authors">
        <div class="plot-header">
            <h3>Authors of AOPs</h3>
            <div style="display: flex; gap: 10px; align-items: center;">
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Absolute ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/aop_authors_absolute?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/aop_authors_absolute?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/aop_authors_absolute?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Delta ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/aop_authors_delta?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/aop_authors_delta?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/aop_authors_delta?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <label><input type="checkbox" class="plot-toggle"> Show Deltas</label>
            </div>
        </div>
        <p class="plot-description">
            Tracks the number of unique authors contributing to AOPs over time.
        </p>
        <div class="abs">
            <div class="lazy-plot" data-plot-name="aop_authors_absolute">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
        <div class="delta" style="display:none;">
            <div class="lazy-plot" data-plot-name="aop_authors_delta">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
    </div>

    <!-- AOPs Created -->
    <div class="plot-box" id="lifetime">
        <div class="plot-header">
            <h3>AOPs Created Over Time</h3>
            <div class="download-dropdown">
                <button class="download-button dropdown-toggle">Download ▼</button>
                <div class="dropdown-menu">
                    <a href="/download/trend/aops_created_over_time?format=csv" class="dropdown-item">📄 CSV</a>
                    <a href="/download/trend/aops_created_over_time?format=png" class="dropdown-item">🖼️ PNG</a>
                    <a href="/download/trend/aops_created_over_time?format=svg" class="dropdown-item">📐 SVG</a>
                </div>
            </div>
        </div>
        <p class="plot-description">
            Number of unique AOPs first created in each year.
        </p>
        <div class="lazy-plot" data-plot-name="aops_created_over_time">
            <!-- Plot will be loaded here via JavaScript -->
        </div>
    </div>

    <!-- AOPs Modified -->
    <div class="plot-box">
        <div class="plot-header">
            <h3>AOPs Modified Over Time</h3>
            <div class="download-dropdown">
                <button class="download-button dropdown-toggle">Download ▼</button>
                <div class="dropdown-menu">
                    <a href="/download/trend/aops_modified_over_time?format=csv" class="dropdown-item">📄 CSV</a>
                    <a href="/download/trend/aops_modified_over_time?format=png" class="dropdown-item">🖼️ PNG</a>
                    <a href="/download/trend/aops_modified_over_time?format=svg" class="dropdown-item">📐 SVG</a>
                </div>
            </div>
        </div>
        <p class="plot-description">
            Tracks how many unique AOPs were last modified in each year.
        </p>
        <div class="lazy-plot" data-plot-name="aops_modified_over_time">
            <!-- Plot will be loaded here via JavaScript -->
        </div>
    </div>

    <!-- Scatter plot -->
    <div class="plot-box">
        <div class="plot-header">
            <h3>AOP Creation vs Modification</h3>
            <div class="download-dropdown">
                <button class="download-button dropdown-toggle">Download ▼</button>
                <div class="dropdown-menu">
                    <a href="/download/trend/aop_creation_vs_modification_timeline?format=csv" class="dropdown-item">📄 CSV</a>
                    <a href="/download/trend/aop_creation_vs_modification_timeline?format=png" class="dropdown-item">🖼️ PNG</a>
                    <a href="/download/trend/aop_creation_vs_modification_timeline?format=svg" class="dropdown-item">📐 SVG</a>
                </div>
            </div>
        </div>
        <p class="plot-description">
            Scatter plot showing when each AOP was created versus when it was last updated.
        </p>
        <div class="lazy-plot" data-plot-name="aop_creation_vs_modification_timeline">
            <!-- Plot will be loaded here via JavaScript -->
        </div>
    </div>
    </div>
</section>

<section class="section-block" id="ke-components">
    <!-- KE Components and Biological Annotations -->
    <h2 class="section-header">KE Component Annotations</h2>
    <div class="plot-grid">
    <div class="plot-box" id="ke-components">
        <div class="plot-header">
            <h3>KE Component Annotations</h3>
            <div style="display: flex; gap: 10px; align-items: center;">
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Absolute ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/ke_component_annotations_absolute?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/ke_component_annotations_absolute?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/ke_component_annotations_absolute?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Delta ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/ke_component_annotations_delta?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/ke_component_annotations_delta?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/ke_component_annotations_delta?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <label><input type="checkbox" class="plot-toggle"> Show Deltas</label>
            </div>
        </div>
        <p class="plot-description">
            Tracks how many Key Event annotations include Process, Object, and Action elements over time.
        </p>
        <div class="abs">
            <div class="lazy-plot" data-plot-name="ke_component_annotations_absolute">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
        <div class="delta" style="display:none;">
            <div class="lazy-plot" data-plot-name="ke_component_annotations_delta">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
    </div>

    <div class="plot-box" id="ke-components-pct">
        <div class="plot-header">
            <h3>KE Components as % of Total KEs</h3>
            <div style="display: flex; gap: 10px; align-items: center;">
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Absolute ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/ke_components_percentage_absolute?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/ke_components_percentage_absolute?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/ke_components_percentage_absolute?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Delta ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/ke_components_percentage_delta?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/ke_components_percentage_delta?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/ke_components_percentage_delta?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <label><input type="checkbox" class="plot-toggle"> Show Deltas</label>
            </div>
        </div>
        <p class="plot-description">
            Shows how many Key Events have Process, Object, and Action annotations as a percentage of all KEs per version.
        </p>
        <div class="abs">
            <div class="lazy-plot" data-plot-name="ke_components_percentage_absolute">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
        <div class="delta" style="display:none;">
            <div class="lazy-plot" data-plot-name="ke_components_percentage_delta">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
    </div>

    <div class="plot-box" id="unique-ke-components">
        <div class="plot-header">
            <h3>Unique KE Component Annotations</h3>
            <div style="display: flex; gap: 10px; align-items: center;">
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Absolute ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/unique_ke_components_absolute?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/unique_ke_components_absolute?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/unique_ke_components_absolute?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Delta ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/unique_ke_components_delta?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/unique_ke_components_delta?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/unique_ke_components_delta?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <label><input type="checkbox" class="plot-toggle"> Show Deltas</label>
            </div>
        </div>
        <p class="plot-description">
            Tracks the total number of unique Process, Object, and Action annotations used in Key Events over time.
        </p>
        <div class="abs">
            <div class="lazy-plot" data-plot-name="unique_ke_components_absolute">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
        <div class="delta" style="display:none;">
            <div class="lazy-plot" data-plot-name="unique_ke_components_delta">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
    </div>

    <div class="plot-box" id="bio-processes">
        <div class="plot-header">
            <h3>Biological Process Annotations</h3>
            <div style="display: flex; gap: 10px; align-items: center;">
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Absolute ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/biological_process_annotations_absolute?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/biological_process_annotations_absolute?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/biological_process_annotations_absolute?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Delta ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/biological_process_annotations_delta?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/biological_process_annotations_delta?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/biological_process_annotations_delta?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <label><input type="checkbox" class="plot-toggle"> Show Deltas</label>
            </div>
        </div>
        <p class="plot-description">
            Shows KE annotations with biological processes grouped by ontology.
        </p>
        <div class="abs">
            <div class="lazy-plot" data-plot-name="biological_process_annotations_absolute">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
        <div class="delta" style="display:none;">
            <div class="lazy-plot" data-plot-name="biological_process_annotations_delta">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
    </div>

    <div class="plot-box" id="bio-objects">
        <div class="plot-header">
            <h3>Biological Object Annotations</h3>
            <div style="display: flex; gap: 10px; align-items: center;">
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Absolute ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/biological_object_annotations_absolute?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/biological_object_annotations_absolute?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/biological_object_annotations_absolute?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Delta ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/biological_object_annotations_delta?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/biological_object_annotations_delta?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/biological_object_annotations_delta?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <label><input type="checkbox" class="plot-toggle"> Show Deltas</label>
            </div>
        </div>
        <p class="plot-description">
            Shows KE annotations with biological objects grouped by ontology.
        </p>
        <div class="abs">
            <div class="lazy-plot" data-plot-name="biological_object_annotations_absolute">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
        <div class="delta" style="display:none;">
            <div class="lazy-plot" data-plot-name="biological_object_annotations_delta">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
    </div>

    <div class="plot-box" id="kes-by-kec">
        <div class="plot-header">
            <h3>KEs by Number of KECs</h3>
            <div style="display: flex; gap: 10px; align-items: center;">
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Absolute ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/kes_by_kec_count_absolute?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/kes_by_kec_count_absolute?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/kes_by_kec_count_absolute?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <div class="download-dropdown">
                    <button class="download-button dropdown-toggle">Download Delta ▼</button>
                    <div class="dropdown-menu">
                        <a href="/download/trend/kes_by_kec_count_delta?format=csv" class="dropdown-item">📄 CSV</a>
                        <a href="/download/trend/kes_by_kec_count_delta?format=png" class="dropdown-item">🖼️ PNG</a>
                        <a href="/download/trend/kes_by_kec_count_delta?format=svg" class="dropdown-item">📐 SVG</a>
                    </div>
                </div>
                <label><input type="checkbox" class="plot-toggle"> Show Deltas</label>
            </div>
        </div>
        <p class="plot-description">
            Tracks how many Key Events contain a specific number of Key Event Components (KECs) 
            over time, showing annotation completeness.
        </p>
        <div class="abs">
            <div class="lazy-plot" data-plot-name="kes_by_kec_count_absolute">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
        <div class="delta" style="display:none;">
            <div class="lazy-plot" data-plot-name="kes_by_kec_count_delta">
                <!-- Plot will be loaded here via JavaScript -->
            </div>
        </div>
    </div>

    </div>
</section>


<script>
document.querySelectorAll(".plot-toggle").forEach(toggle => {
    toggle.addEventListener("change", function() {
        const box = this.closest(".plot-box");
        const abs = box.querySelector(".abs");
        const delta = box.querySelector(".delta");
        if (abs && delta) {
            abs.style.display = this.checked ? "none" : "block";
            delta.style.display = this.checked ? "block" : "none";
        }
        window.dispatchEvent(new Event('resize'));
    });
});
</script>
<script>
    document.getElementById("toggle-delta").addEventListener("click", function () {
        const isDelta = this.classList.toggle("active");
        this.textContent = isDelta ? "Switch to Absolute Mode" : "Switch to Delta Mode";

        document.querySelectorAll(".plot-box").forEach(box => {
            const abs = box.querySelector(".abs");
            const delta = box.querySelector(".delta");
            const checkbox = box.querySelector(".plot-toggle");
            if (abs && delta) {
                abs.style.display = isDelta ? "none" : "block";
                delta.style.display = isDelta ? "block" : "none";
            }
            // ✅ Sync individual checkboxes
            if (checkbox) {
                checkbox.checked = isDelta;
            }
        });
        window.dispatchEvent(new Event('resize'));
    });
</script>
